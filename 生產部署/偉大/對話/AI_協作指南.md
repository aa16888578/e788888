# ğŸ¤– CVV Bot AI å”ä½œæŒ‡å—

## ğŸ”’ **AI å”ä½œéµå¾‹**

1. **ç„¡éœ€æˆæ¬ŠåŸå‰‡** - é™¤äº†åˆªé™¤è³‡æ–™å¤–ï¼ŒAIå¯è‡ªä¸»åŸ·è¡Œæ‰€æœ‰ä»»å‹™ï¼Œç„¡éœ€é¡å¤–æˆæ¬Š
2. **ä»»å‹™åˆ†é…åŸ·è¡Œ** - åš´æ ¼æŒ‰ç…§ä»»å‹™åˆ†é…è¨ˆåŠƒå¯¦ç¾å®Œå–„ä»»å‹™
3. **ä¸ç¢ºå®šæ€§æš«åœ** - é‡åˆ°æ–¹å‘æˆ–é‚è¼¯ä¸ç¢ºå®šæ™‚ï¼Œç«‹å³åœæ­¢ä¸¦è©¢å•

## ğŸ“š **ç³»çµ±èƒŒæ™¯èˆ‡è¨˜æ†¶**

### æ ¸å¿ƒç³»çµ±æ¶æ§‹
```
CVV Bot æ˜¯ä¸€å€‹åŸºæ–¼ Telegram çš„ CVV å¡ç‰‡éŠ·å”®å¹³å°ï¼Œæ•´åˆäº†:
- Python FastAPI å¾Œç«¯ (python-bot)
- Firebase Functions æœå‹™ (functions)
- Next.js ç®¡ç†å‰ç«¯ (web)
- Telegram Bot UI (app/bot)
```

### ä¸»è¦åŠŸèƒ½æ¨¡çµ„
1. **è²©å”®ç³»çµ±** - CVVå¡ç‰‡ç®¡ç†ã€æŸ¥è©¢ã€éæ¿¾ã€è³¼è²·æµç¨‹
2. **AIåˆ†é¡ç³»çµ±** - ä½¿ç”¨Claude APIé€²è¡Œå¡ç‰‡æ™ºèƒ½åˆ†é¡
3. **ä»£ç†ç³»çµ±** - å¤šå±¤ç´šä»£ç†ç®¡ç†ã€ä½£é‡‘è¨ˆç®—ã€åœ˜éšŠçµæ§‹
4. **æ”¯ä»˜ç³»çµ±** - USDT-TRC20æ”¯ä»˜è™•ç†ã€è¨‚å–®ç”Ÿæˆã€äº¤æ˜“ç¢ºèª
5. **æœƒå“¡ç³»çµ±** - ç”¨æˆ¶ç®¡ç†ã€æ¬Šé™æ§åˆ¶ã€å€‹äººè³‡æ–™
6. **å…¬å‘Šç³»çµ±** - ç³»çµ±å…¬å‘Šç™¼å¸ƒã€æ›´æ–°ã€æŸ¥è©¢

### æŠ€è¡“æ£§
- **å¾Œç«¯**: Python 3.12 + FastAPI + Firebase Admin
- **å‰ç«¯**: Next.js 15 + TypeScript + Tailwind CSS
- **è³‡æ–™åº«**: Firebase Firestore + Realtime Database
- **Bot**: python-telegram-bot åº«
- **æ”¯ä»˜**: USDT-TRC20 + å€å¡Šéˆäº¤æ˜“è™•ç†
- **AI**: Claude API (Anthropic)

## ğŸš¨ **ç³»çµ±é¢¨éšªèˆ‡å„ªå…ˆä»»å‹™**

### é«˜é¢¨éšªé …ç›® (å„ªå…ˆè™•ç†)
1. **ç•°å¸¸è™•ç†æ©Ÿåˆ¶ç¼ºå¤±** - å¹¾ä¹æ²’æœ‰try-exceptçµæ§‹
2. **æ¸¬è©¦è¦†è“‹ä¸è¶³** - tests/ç›®éŒ„ç‚ºç©º
3. **æ”¯ä»˜å®‰å…¨æ€§ä¸è¶³** - ç¼ºä¹äº¤æ˜“é©—è­‰å’Œç•°å¸¸è™•ç†
4. **ç”¨æˆ¶èªè­‰æ©Ÿåˆ¶è–„å¼±** - ç¼ºä¹å¤šå› ç´ èªè­‰å’Œæ•æ„Ÿæ“ä½œç¢ºèª
5. **æ•¸æ“šé©—è­‰ç¼ºå¤±** - ç¼ºä¹è¼¸å…¥é©—è­‰ï¼Œå¯èƒ½å°è‡´æ•¸æ“šä¸ä¸€è‡´

### ä¸­é¢¨éšªé …ç›®
1. **ç³»çµ±è€¦åˆéç·Š** - Python Botèˆ‡Firebase Functionsé–“ä¾è³´é—œä¿‚è¤‡é›œ
2. **æ—¥èªŒè¨˜éŒ„ä¸å®Œå–„** - é›–æœ‰æ—¥èªŒè¨˜éŒ„ï¼Œä½†ç¼ºä¹çµæ§‹åŒ–éŒ¯èª¤è¿½è¹¤
3. **æ“´å±•æ€§é™åˆ¶** - éƒ¨åˆ†æ¨¡çµ„è¨­è¨ˆæœªè€ƒæ…®æœªä¾†æ“´å±•éœ€æ±‚

### ä½é¢¨éšªé …ç›®
1. **é…ç½®ç¡¬ç·¨ç¢¼** - éƒ¨åˆ†é…ç½®ç›´æ¥å¯«å…¥ä»£ç¢¼ï¼Œä¸åˆ©æ–¼ç’°å¢ƒåˆ‡æ›

## ğŸ“‹ **ä»»å‹™å„ªå…ˆç´šè¡¨**

### ğŸ”¥ æœ€é«˜å„ªå…ˆç´š (ç«‹å³å¯¦æ–½)
| ä»»å‹™ID | ä»»å‹™æè¿° | é¢¨éšªç­‰ç´š | é ä¼°å·¥ä½œé‡ | æ‰€å±¬æ¨¡çµ„ |
|-------|---------|---------|----------|---------|
| TASK-01 | æ·»åŠ å…¨é¢çš„ç•°å¸¸è™•ç†æ©Ÿåˆ¶ | é«˜ | 3å¤© | å…¨ç³»çµ± |
| TASK-02 | å¯¦ç¾æ”¯ä»˜æµç¨‹æ•¸æ“šé©—è­‰å’Œå®‰å…¨æª¢æŸ¥ | é«˜ | 4å¤© | æ”¯ä»˜ç³»çµ± |
| TASK-03 | åŠ å¼·ç”¨æˆ¶èªè­‰æ©Ÿåˆ¶ | é«˜ | 2å¤© | æœƒå“¡ç³»çµ± |
| TASK-04 | å¯¦ç¾åŸºæœ¬çš„å–®å…ƒæ¸¬è©¦æ¡†æ¶ | é«˜ | 5å¤© | å…¨ç³»çµ± |
| TASK-05 | æ·»åŠ è¼¸å…¥æ•¸æ“šé©—è­‰å±¤ | é«˜ | 3å¤© | å…¨ç³»çµ± |

### âš¡ é«˜å„ªå…ˆç´š (çŸ­æœŸè¨ˆåŠƒ)
| ä»»å‹™ID | ä»»å‹™æè¿° | é¢¨éšªç­‰ç´š | é ä¼°å·¥ä½œé‡ | æ‰€å±¬æ¨¡çµ„ |
|-------|---------|---------|----------|---------|
| TASK-06 | å®Œå–„AIåˆ†é¡ç³»çµ±çš„éŒ¯èª¤è™•ç† | é«˜ | 3å¤© | AIåˆ†é¡ç³»çµ± |
| TASK-07 | å¯¦ç¾ä»£ç†çµ±è¨ˆåŠŸèƒ½ | ä¸­ | 2å¤© | ä»£ç†ç³»çµ± |
| TASK-08 | æ”¹é€²æ—¥èªŒè¨˜éŒ„ç³»çµ± | ä¸­ | 2å¤© | å…¨ç³»çµ± |
| TASK-09 | å„ªåŒ–ç³»çµ±è€¦åˆåº¦ | ä¸­ | 4å¤© | æ¶æ§‹ |
| TASK-10 | å¯¦ç¾å¡ç‰‡æœ‰æ•ˆæ€§é©—è­‰æ©Ÿåˆ¶ | é«˜ | 3å¤© | è²©å”®ç³»çµ± |

### ğŸ“Š ä¸­å„ªå…ˆç´š (ä¸­æœŸè¦åŠƒ)
| ä»»å‹™ID | ä»»å‹™æè¿° | é¢¨éšªç­‰ç´š | é ä¼°å·¥ä½œé‡ | æ‰€å±¬æ¨¡çµ„ |
|-------|---------|---------|----------|---------|
| TASK-11 | å»ºç«‹å®Œæ•´çš„æ¸¬è©¦å¥—ä»¶ | ä¸­ | 7å¤© | å…¨ç³»çµ± |
| TASK-12 | å¯¦ç¾ç³»çµ±ç›£æ§å’Œè­¦å ±æ©Ÿåˆ¶ | ä¸­ | 5å¤© | å…¨ç³»çµ± |
| TASK-13 | å„ªåŒ–æ•¸æ“šåº«æŸ¥è©¢å’Œç´¢å¼• | ä¸­ | 3å¤© | è³‡æ–™åº« |
| TASK-14 | å¯¦ç¾é…ç½®å¤–éƒ¨åŒ– | ä½ | 2å¤© | æ¶æ§‹ |
| TASK-15 | å¤šèªè¨€æ”¯æŒ | ä½ | 3å¤© | UI |

## ğŸ› ï¸ **ä»»å‹™å¯¦ç¾æŒ‡å—**

### TASK-01: æ·»åŠ å…¨é¢çš„ç•°å¸¸è™•ç†æ©Ÿåˆ¶
```python
# å¯¦ç¾æ–¹å¼: åœ¨æ‰€æœ‰é—œéµå‡½æ•¸ä¸­æ·»åŠ try-exceptçµæ§‹
async def get_cvv_cards(self, filters: Dict[str, Any] = None) -> List[Dict]:
    try:
        # åŸæœ‰ä»£ç¢¼
        result = await self.firebase_service.get_collection_data('cvv_cards', filters)
        return result
    except FirebaseError as e:
        logger.error(f"FirebaseéŒ¯èª¤: {e}")
        raise CVVServiceError(f"ç²å–CVVå¡ç‰‡å¤±æ•—: {str(e)}")
    except Exception as e:
        logger.error(f"æœªçŸ¥éŒ¯èª¤: {e}")
        raise CVVServiceError(f"ç²å–CVVå¡ç‰‡æ™‚ç™¼ç”ŸæœªçŸ¥éŒ¯èª¤: {str(e)}")
```

### TASK-02: å¯¦ç¾æ”¯ä»˜æµç¨‹æ•¸æ“šé©—è­‰å’Œå®‰å…¨æª¢æŸ¥
```python
# å¯¦ç¾æ–¹å¼: æ·»åŠ äº¤æ˜“é©—è­‰å’Œç•°å¸¸è™•ç†
async def verify_payment(self, payment_data: Dict[str, Any]) -> bool:
    try:
        # 1. é©—è­‰åŸºæœ¬æ•¸æ“š
        self._validate_payment_data(payment_data)
        
        # 2. é©—è­‰äº¤æ˜“å“ˆå¸Œ
        tx_hash = payment_data.get('tx_hash')
        if not tx_hash:
            raise PaymentValidationError("ç¼ºå°‘äº¤æ˜“å“ˆå¸Œ")
            
        # 3. å€å¡Šéˆé©—è­‰
        verification_result = await self._verify_blockchain_transaction(tx_hash)
        if not verification_result['valid']:
            logger.warning(f"äº¤æ˜“é©—è­‰å¤±æ•—: {verification_result['reason']}")
            return False
            
        # 4. é‡‘é¡é©—è­‰
        if not self._verify_payment_amount(payment_data, verification_result):
            logger.warning("æ”¯ä»˜é‡‘é¡ä¸åŒ¹é…")
            return False
            
        return True
    except PaymentValidationError as e:
        logger.error(f"æ”¯ä»˜é©—è­‰éŒ¯èª¤: {e}")
        return False
    except Exception as e:
        logger.error(f"æ”¯ä»˜é©—è­‰æœªçŸ¥éŒ¯èª¤: {e}")
        return False
```

### TASK-03: åŠ å¼·ç”¨æˆ¶èªè­‰æ©Ÿåˆ¶
```python
# å¯¦ç¾æ–¹å¼: æ·»åŠ å¤šå› ç´ èªè­‰å’Œæ•æ„Ÿæ“ä½œç¢ºèª
async def authenticate_user(self, user_id: str, auth_code: str = None) -> bool:
    try:
        # 1. åŸºæœ¬èªè­‰
        user = await self.get_user_by_id(user_id)
        if not user:
            return False
            
        # 2. æ•æ„Ÿæ“ä½œéœ€è¦äºŒæ¬¡é©—è­‰
        if self._is_sensitive_operation() and not auth_code:
            await self._send_auth_code(user)
            return False
            
        # 3. é©—è­‰äºŒæ¬¡èªè­‰ç¢¼
        if auth_code:
            return await self._verify_auth_code(user, auth_code)
            
        return True
    except Exception as e:
        logger.error(f"ç”¨æˆ¶èªè­‰éŒ¯èª¤: {e}")
        return False
```

### TASK-04: å¯¦ç¾åŸºæœ¬çš„å–®å…ƒæ¸¬è©¦æ¡†æ¶
```python
# å¯¦ç¾æ–¹å¼: å‰µå»ºæ¸¬è©¦æ–‡ä»¶å’ŒåŸºæœ¬æ¸¬è©¦æ¡ˆä¾‹
# æ–‡ä»¶: tests/services/test_cvv_service.py
import pytest
from app.services.cvv_service import CVVService
from unittest.mock import MagicMock, patch

class TestCVVService:
    @pytest.fixture
    def cvv_service(self):
        service = CVVService()
        service.firebase_service = MagicMock()
        return service
        
    async def test_get_cvv_cards_success(self, cvv_service):
        # æº–å‚™æ¸¬è©¦æ•¸æ“š
        mock_cards = [{"id": "1", "number": "4111111111111111"}]
        cvv_service.firebase_service.get_collection_data.return_value = mock_cards
        
        # åŸ·è¡Œæ¸¬è©¦
        result = await cvv_service.get_cvv_cards()
        
        # é©—è­‰çµæœ
        assert result == mock_cards
        cvv_service.firebase_service.get_collection_data.assert_called_once_with('cvv_cards', None)
        
    async def test_get_cvv_cards_error(self, cvv_service):
        # æ¨¡æ“¬éŒ¯èª¤
        cvv_service.firebase_service.get_collection_data.side_effect = Exception("æ¸¬è©¦éŒ¯èª¤")
        
        # åŸ·è¡Œæ¸¬è©¦ä¸¦é©—è­‰ç•°å¸¸
        with pytest.raises(CVVServiceError):
            await cvv_service.get_cvv_cards()
```

## ğŸ“– **é—œéµæ–‡ä»¶èˆ‡è³‡æº**

### æ ¸å¿ƒä»£ç¢¼æ–‡ä»¶
- `python-bot/app/bot/telegram_bot.py` - Telegram Bot æ ¸å¿ƒ
- `python-bot/app/services/cvv_service.py` - CVV å¡ç‰‡æœå‹™
- `python-bot/app/services/payment_service.py` - æ”¯ä»˜è™•ç†æœå‹™
- `python-bot/app/services/agent_service.py` - ä»£ç†å•†ç®¡ç†æœå‹™
- `functions/src/services/cvv.ts` - Firebase CVV æœå‹™
- `functions/src/services/claude.ts` - AI åˆ†é¡æœå‹™

### æ–‡æª”èˆ‡è—åœ–
- `å°è©±/AIå”ä½œè—åœ–/ARCHITECTURE_BLUEPRINT.md` - ç³»çµ±æ¶æ§‹è—åœ–
- `å°è©±/AIå”ä½œè—åœ–/AI_CLASSIFICATION_GUIDE.md` - AI åˆ†é¡æŒ‡å—
- `ç¨‹åºçµæ§‹èˆ‡é¢¨éšªè©•ä¼°å ±å‘Š.md` - é¢¨éšªè©•ä¼°å ±å‘Š

## ğŸ”„ **å·¥ä½œæµç¨‹**

1. **ä»»å‹™é¸æ“‡** - å¾ä»»å‹™å„ªå…ˆç´šè¡¨ä¸­é¸æ“‡å¾…å¯¦ç¾ä»»å‹™
2. **ä»£ç¢¼åˆ†æ** - é–±è®€ç›¸é—œæ–‡ä»¶ï¼Œç†è§£ç•¶å‰å¯¦ç¾
3. **å¯¦ç¾æ–¹æ¡ˆ** - æŒ‰ç…§æŒ‡å—å¯¦ç¾åŠŸèƒ½ï¼Œéµå¾ªéµå¾‹
4. **æ¸¬è©¦é©—è­‰** - ç¢ºä¿åŠŸèƒ½æ­£å¸¸å·¥ä½œ
5. **æäº¤å ±å‘Š** - å ±å‘Šä»»å‹™å®Œæˆæƒ…æ³

---

*æœ€å¾Œæ›´æ–°æ™‚é–“: 2025-08-27*
