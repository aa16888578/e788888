{"fsPath":"/home/a0928997578_gmail_com/偉大/ARCHITECTURE_BLUEPRINT.md","fileUuid":"90f1003d-34a6-4369-937a-b8b416bade6c","fileSizeBytes":38116,"numLines":1686,"diffChanges":[{"originalStartLineNumberOneIndexed":1435,"originalEndLineNumberExclusiveOneIndexed":1435,"modifiedStartLineNumberOneIndexed":1435,"modifiedEndLineNumberExclusiveOneIndexed":1626,"addedLines":["","---","","## 🌍 **環境配置與部署指南 (Environment Configuration & Deployment Guide)**","","### **📋 環境配置文件**","本項目包含完整的環境配置範例和說明文檔：","","#### **1. 環境變數範例文件**","- **文件路徑**: `env.example`","- **用途**: 包含所有必要的環境變數配置","- **使用方法**: 複製為 `.env` 並填入實際值","","#### **2. 環境配置說明文檔**","- **文件路徑**: `ENVIRONMENT_SETUP.md`","- **內容**: 詳細的配置說明、故障排除和最佳實踐","","### **🚀 快速配置步驟**","","#### **步驟 1: 複製環境配置**","```bash","cd /home/a0928997578_gmail_com/偉大","cp env.example .env","```","","#### **步驟 2: 編輯配置文件**","根據實際情況編輯 `.env` 文件中的配置值。","","#### **步驟 3: 重啟服務**","配置完成後重啟相關服務使配置生效。","","### **🔑 核心配置項**","","#### **Firebase 配置 (必需)**","```bash","FIREBASE_PROJECT_ID=your-project-id","FIREBASE_PRIVATE_KEY=\"-----BEGIN PRIVATE KEY-----\\nYour Private Key Here\\n-----END PRIVATE KEY-----\\n\"","FIREBASE_CLIENT_EMAIL=firebase-adminsdk-xxxxx@your-project-id.iam.gserviceaccount.com","```","","#### **Telegram Bot 配置 (必需)**","```bash","TELEGRAM_BOT_TOKEN=your-telegram-bot-token","TELEGRAM_WEBHOOK_SECRET=your-webhook-secret","TELEGRAM_WEBHOOK_URL=https://your-project-id.cloudfunctions.net/telegramWebhook","```","","#### **支付系統配置 (必需)**","```bash","TRON_WALLET_ADDRESS=TYourTronWalletAddressHere","ETHEREUM_WALLET_ADDRESS=0xYourEthereumWalletAddressHere","SYSTEM_WALLET_ADDRESS=TYourSystemWalletAddressHere","```","","#### **安全配置 (必需)**","```bash","JWT_SECRET=your-jwt-secret-key-here","JWT_EXPIRES_IN=24h","ALLOWED_ORIGINS=https://your-domain.com","```","","### **📚 配置文檔結構**","","```","偉大/","├── env.example              # 環境變數範例","├── ENVIRONMENT_SETUP.md     # 環境配置說明","├── WORK_PROGRESS.md         # 工作進度報告","├── ARCHITECTURE_BLUEPRINT.md # 系統架構藍圖","└── functions/               # 後端代碼","    ├── src/","    │   ├── services/        # 服務層","    │   ├── types/           # 類型定義","    │   └── routes/          # API 路由","    └── package.json         # 依賴配置","```","","### **🔧 開發環境設置**","","#### **1. 安裝依賴**","```bash","cd functions","npm install","```","","#### **2. 編譯 TypeScript**","```bash","npm run build","```","","#### **3. 本地測試**","```bash","npm run dev","```","","#### **4. 部署到 Firebase**","```bash","firebase deploy --only functions","```","","### **📱 Telegram Bot 設置**","","#### **1. 創建 Bot**","1. 在 Telegram 中搜索 `@BotFather`","2. 發送 `/newbot` 命令","3. 設置 Bot 名稱和用戶名","4. 獲取 Bot Token","","#### **2. 設置 Webhook**","```bash","curl -F \"url=https://your-project-id.cloudfunctions.net/telegramWebhook\" \\","     https://api.telegram.org/bot<BOT_TOKEN>/setWebhook","```","","### **💰 支付系統配置**","","#### **1. USDT-TRC20 配置**","- 獲取 Tron 錢包地址","- 配置 Tron API 密鑰","- 設置確認數 (建議 20)","","#### **2. 匯率 API 配置**","- CoinGecko API (免費，推薦)","- Binance API (備用)","","### **🔒 安全注意事項**","","#### **1. 環境變數保護**","- 永遠不要將 `.env` 文件提交到版本控制","- 使用強密鑰和密碼","- 定期更換 API 密鑰","","#### **2. 權限管理**","- 限制 API 密鑰的權限範圍","- 使用專用的服務帳戶","- 啟用安全日誌記錄","","### **📊 監控和維護**","","#### **1. 性能監控**","```bash","ENABLE_PERFORMANCE_MONITORING=true","ENABLE_ERROR_TRACKING=true","ENABLE_ANALYTICS=true","```","","#### **2. 日誌配置**","```bash","LOG_LEVEL=info","LOG_FILE_PATH=./logs/app.log","```","","#### **3. 備份配置**","```bash","ENABLE_AUTO_BACKUP=true","BACKUP_FREQUENCY_HOURS=24","BACKUP_RETENTION_DAYS=30","```","","### **🚨 故障排除**","","#### **常見問題解決**","","1. **Firebase 連接失敗**","   - 檢查項目 ID 和服務帳戶權限","   - 確認網絡連接","","2. **Telegram Bot 無響應**","   - 檢查 Bot Token 和 Webhook 設置","   - 確認函數部署狀態","","3. **支付系統錯誤**","   - 檢查錢包地址格式","   - 確認網絡配置和 API 密鑰","","4. **環境變數未生效**","   - 重啟相關服務","   - 檢查變數名稱拼寫","","### **📞 技術支持**","","#### **文檔資源**","- [Firebase 文檔](https://firebase.google.com/docs)","- [Telegram Bot API](https://core.telegram.org/bots/api)","- [Tron 開發文檔](https://developers.tron.network/)","- [Ethereum 開發文檔](https://ethereum.org/developers/)","","#### **項目文檔**","- `ENVIRONMENT_SETUP.md` - 詳細配置說明","- `WORK_PROGRESS.md` - 開發進度和狀態","- `ARCHITECTURE_BLUEPRINT.md` - 系統架構設計"],"tokenizedAddedLines":[2,5,2,1001029,2,1001030,1001031,2,1001032,1001033,1001034,1001035,2,1001036,1001037,1001038,2,1001039,2,1001040,339,1001041,1001042,50,2,1001043,1001044,2,1001045,1001046,2,1001047,2,1001048,339,1001049,1001050,1001051,50,2,1001052,339,1001053,1001054,1001055,50,2,1001056,339,1001057,1001058,1001059,50,2,1001060,339,1001061,1001062,1001063,50,2,1001064,2,50,1001065,1001066,1001067,1001068,1001069,1001070,1001071,1001072,1001073,1001074,1001075,50,2,1001076,2,1001077,339,1001078,1001079,50,2,1001080,339,1001081,50,2,1001082,339,1001083,50,2,1001084,339,1001085,50,2,1001086,2,1001087,1001088,1001089,1001090,1001091,2,1001092,339,1001093,345,50,2,1001094,2,1001095,1001096,1001097,1001098,2,1001099,1001100,1001101,2,1001102,2,1001103,1001104,1001105,1001106,2,1001107,1001108,1001109,1001110,2,1001111,2,1001112,339,1001113,1001114,1001115,50,2,1001116,339,1001117,1001118,50,2,1001119,339,1001120,1001121,1001122,50,2,1001123,2,1001124,2,1001125,1001126,1001127,2,1001128,1001129,1001130,2,1001131,1001132,1001133,2,1001134,1001135,1001136,2,1001137,2,1001138,1001139,1001140,1001141,1001142,2,1001143,1001144,1001145,1001146]},{"originalStartLineNumberOneIndexed":1440,"originalEndLineNumberExclusiveOneIndexed":1441,"modifiedStartLineNumberOneIndexed":1631,"modifiedEndLineNumberExclusiveOneIndexed":1632,"addedLines":["### **第一階段：基礎架構** 🏗️ ✅"],"tokenizedAddedLines":[1001147]},{"originalStartLineNumberOneIndexed":1442,"originalEndLineNumberExclusiveOneIndexed":1451,"modifiedStartLineNumberOneIndexed":1633,"modifiedEndLineNumberExclusiveOneIndexed":1644,"addedLines":["- [x] 數據庫設計和結構 (基於 Telegram 用戶)","- [x] 基礎 API 架構","- [x] Telegram 用戶認證系統","","### **第二階段：Telegram Bot** 🤖 ✅","- [x] Bot 基礎功能","- [x] 商品查詢功能","- [x] 購物車管理","- [x] 訂單處理","- [x] 支付集成測試","- [x] Bot 命令擴展"],"tokenizedAddedLines":[1001148,1001149,1001150,2,1001151,1001152,1001153,1001154,1001155,1001156,1001157]},{"originalStartLineNumberOneIndexed":1486,"originalEndLineNumberExclusiveOneIndexed":1487,"modifiedStartLineNumberOneIndexed":1679,"modifiedEndLineNumberExclusiveOneIndexed":1680,"addedLines":["**架構狀態**: 第二階段完成，包含完整的 Telegram Bot 功能 🚀  "],"tokenizedAddedLines":[1001158]},{"originalStartLineNumberOneIndexed":1488,"originalEndLineNumberExclusiveOneIndexed":1489,"modifiedStartLineNumberOneIndexed":1681,"modifiedEndLineNumberExclusiveOneIndexed":1682,"addedLines":["**版本**: 2.2.0 - 多平台版本 + 代理系統 + USDT-TRC20 支付 + 環境配置指南  "],"tokenizedAddedLines":[1001159]},{"originalStartLineNumberOneIndexed":1491,"originalEndLineNumberExclusiveOneIndexed":1491,"modifiedStartLineNumberOneIndexed":1684,"modifiedEndLineNumberExclusiveOneIndexed":1686,"addedLines":["","**環境配置已完成，下一位開發者可以直接使用 `env.example` 和 `ENVIRONMENT_SETUP.md` 進行系統配置和部署。**"],"tokenizedAddedLines":[2,1001160]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_MODIFIED"}