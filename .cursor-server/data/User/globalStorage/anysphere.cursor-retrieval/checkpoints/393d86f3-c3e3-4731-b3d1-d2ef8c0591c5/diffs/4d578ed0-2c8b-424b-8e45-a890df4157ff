{"fsPath":"/home/a0928997578_gmail_com/å‰å¤§/scripts/build.sh","fileUuid":"4d578ed0-2c8b-424b-8e45-a890df4157ff","fileSizeBytes":6616,"numLines":337,"diffChanges":[{"originalStartLineNumberOneIndexed":1,"originalEndLineNumberExclusiveOneIndexed":1,"modifiedStartLineNumberOneIndexed":1,"modifiedEndLineNumberExclusiveOneIndexed":338,"addedLines":["#!/bin/bash","","# ========================================","# ShopBot å¤šå¹³å°é›»å•†ç³»çµ± - çµ±ä¸€æ§‹å»ºè…³æœ¬","# ========================================","","set -e  # é‡åˆ°éŒ¯èª¤æ™‚é€€å‡º","","# é¡è‰²å®šç¾©","RED='\\033[0;31m'","GREEN='\\033[0;32m'","YELLOW='\\033[1;33m'","BLUE='\\033[0;34m'","NC='\\033[0m' # No Color","","# æ—¥èªŒå‡½æ•¸","log_info() {","    echo -e \"${BLUE}[INFO]${NC} $1\"","}","","log_success() {","    echo -e \"${GREEN}[SUCCESS]${NC} $1\"","}","","log_warning() {","    echo -e \"${YELLOW}[WARNING]${NC} $1\"","}","","log_error() {","    echo -e \"${RED}[ERROR]${NC} $1\"","}","","# æª¢æŸ¥ Node.js ç‰ˆæœ¬","check_node_version() {","    log_info \"æª¢æŸ¥ Node.js ç‰ˆæœ¬...\"","    ","    if ! command -v node &> /dev/null; then","        log_error \"Node.js æœªå®‰è£ï¼Œè«‹å…ˆå®‰è£ Node.js 18+\"","        exit 1","    fi","    ","    NODE_VERSION=$(node -v | cut -d'v' -f2)","    NODE_MAJOR=$(echo $NODE_VERSION | cut -d'.' -f1)","    ","    if [ \"$NODE_MAJOR\" -lt 18 ]; then","        log_error \"Node.js ç‰ˆæœ¬éä½ï¼Œéœ€è¦ 18+ï¼Œç•¶å‰ç‰ˆæœ¬: $NODE_VERSION\"","        exit 1","    fi","    ","    log_success \"Node.js ç‰ˆæœ¬æª¢æŸ¥é€šé: $NODE_VERSION\"","}","","# æª¢æŸ¥ npm ç‰ˆæœ¬","check_npm_version() {","    log_info \"æª¢æŸ¥ npm ç‰ˆæœ¬...\"","    ","    if ! command -v npm &> /dev/null; then","        log_error \"npm æœªå®‰è£ï¼Œè«‹å…ˆå®‰è£ npm 8+\"","        exit 1","    fi","    ","    NPM_VERSION=$(npm -v)","    NPM_MAJOR=$(echo $NPM_VERSION | cut -d'.' -f1)","    ","    if [ \"$NPM_MAJOR\" -lt 8 ]; then","        log_error \"npm ç‰ˆæœ¬éä½ï¼Œéœ€è¦ 8+ï¼Œç•¶å‰ç‰ˆæœ¬: $NPM_VERSION\"","        exit 1","    fi","    ","    log_success \"npm ç‰ˆæœ¬æª¢æŸ¥é€šé: $NPM_VERSION\"","}","","# æ¸…ç†æ§‹å»ºæ–‡ä»¶","clean_build_files() {","    log_info \"æ¸…ç†æ§‹å»ºæ–‡ä»¶...\"","    ","    # æ¸…ç†ç®¡ç†å¾Œå°","    if [ -d \"admin/.next\" ]; then","        rm -rf admin/.next","        log_info \"å·²æ¸…ç† admin/.next\"","    fi","    ","    if [ -d \"admin/out\" ]; then","        rm -rf admin/out","        log_info \"å·²æ¸…ç† admin/out\"","    fi","    ","    if [ -d \"admin/dist\" ]; then","        rm -rf admin/dist","        log_info \"å·²æ¸…ç† admin/dist\"","    fi","    ","    # æ¸…ç† MiniWeb","    if [ -d \"web/.next\" ]; then","        rm -rf web/.next","        log_info \"å·²æ¸…ç† web/.next\"","    fi","    ","    if [ -d \"web/out\" ]; then","        rm -rf web/out","        log_info \"å·²æ¸…ç† web/out\"","    fi","    ","    if [ -d \"web/dist\" ]; then","        rm -rf web/dist","        log_info \"å·²æ¸…ç† web/dist\"","    fi","    ","    # æ¸…ç†å¾Œç«¯æœå‹™","    if [ -d \"functions/dist\" ]; then","        rm -rf functions/dist","        log_info \"å·²æ¸…ç† functions/dist\"","    fi","    ","    log_success \"æ§‹å»ºæ–‡ä»¶æ¸…ç†å®Œæˆ\"","}","","# å®‰è£ä¾è³´","install_dependencies() {","    log_info \"å®‰è£é …ç›®ä¾è³´...\"","    ","    # å®‰è£æ ¹ç›®éŒ„ä¾è³´","    if [ -f \"package.json\" ]; then","        log_info \"å®‰è£æ ¹ç›®éŒ„ä¾è³´...\"","        npm install","    fi","    ","    # å®‰è£ç®¡ç†å¾Œå°ä¾è³´","    if [ -d \"admin\" ] && [ -f \"admin/package.json\" ]; then","        log_info \"å®‰è£ç®¡ç†å¾Œå°ä¾è³´...\"","        cd admin","        npm install","        cd ..","    fi","    ","    # å®‰è£ MiniWeb ä¾è³´","    if [ -d \"web\" ] && [ -f \"web/package.json\" ]; then","        log_info \"å®‰è£ MiniWeb ä¾è³´...\"","        cd web","        npm install","        cd ..","    fi","    ","    # å®‰è£å¾Œç«¯æœå‹™ä¾è³´","    if [ -d \"functions\" ] && [ -f \"functions/package.json\" ]; then","        log_info \"å®‰è£å¾Œç«¯æœå‹™ä¾è³´...\"","        cd functions","        npm install","        cd ..","    fi","    ","    log_success \"æ‰€æœ‰ä¾è³´å®‰è£å®Œæˆ\"","}","","# æ§‹å»ºç®¡ç†å¾Œå°","build_admin() {","    log_info \"æ§‹å»ºç®¡ç†å¾Œå°...\"","    ","    if [ -d \"admin\" ] && [ -f \"admin/package.json\" ]; then","        cd admin","        ","        # æª¢æŸ¥æ˜¯å¦æœ‰æ§‹å»ºè…³æœ¬","        if npm run | grep -q \"build\"; then","            npm run build","            log_success \"ç®¡ç†å¾Œå°æ§‹å»ºå®Œæˆ\"","        else","            log_warning \"ç®¡ç†å¾Œå°æ²’æœ‰æ§‹å»ºè…³æœ¬ï¼Œè·³é\"","        fi","        ","        cd ..","    else","        log_warning \"ç®¡ç†å¾Œå°ç›®éŒ„ä¸å­˜åœ¨ï¼Œè·³é\"","    fi","}","","# æ§‹å»º MiniWeb","build_web() {","    log_info \"æ§‹å»º MiniWeb...\"","    ","    if [ -d \"web\" ] && [ -f \"web/package.json\" ]; then","        cd web","        ","        # æª¢æŸ¥æ˜¯å¦æœ‰æ§‹å»ºè…³æœ¬","        if npm run | grep -q \"build\"; then","            npm run build","            log_success \"MiniWeb æ§‹å»ºå®Œæˆ\"","        else","            log_warning \"MiniWeb æ²’æœ‰æ§‹å»ºè…³æœ¬ï¼Œè·³é\"","        fi","        ","        cd ..","    else","        log_warning \"MiniWeb ç›®éŒ„ä¸å­˜åœ¨ï¼Œè·³é\"","    fi","}","","# æ§‹å»ºå¾Œç«¯æœå‹™","build_functions() {","    log_info \"æ§‹å»ºå¾Œç«¯æœå‹™...\"","    ","    if [ -d \"functions\" ] && [ -f \"functions/package.json\" ]; then","        cd functions","        ","        # æª¢æŸ¥æ˜¯å¦æœ‰æ§‹å»ºè…³æœ¬","        if npm run | grep -q \"build\"; then","            npm run build","            log_success \"å¾Œç«¯æœå‹™æ§‹å»ºå®Œæˆ\"","        else","            log_warning \"å¾Œç«¯æœå‹™æ²’æœ‰æ§‹å»ºè…³æœ¬ï¼Œè·³é\"","        fi","        ","        cd ..","    else","        log_warning \"å¾Œç«¯æœå‹™ç›®éŒ„ä¸å­˜åœ¨ï¼Œè·³é\"","    fi","}","","# æª¢æŸ¥æ§‹å»ºçµæœ","check_build_results() {","    log_info \"æª¢æŸ¥æ§‹å»ºçµæœ...\"","    ","    local build_success=true","    ","    # æª¢æŸ¥ç®¡ç†å¾Œå°","    if [ -d \"admin\" ]; then","        if [ -d \"admin/.next\" ] || [ -d \"admin/out\" ] || [ -d \"admin/dist\" ]; then","            log_success \"ç®¡ç†å¾Œå°æ§‹å»ºæˆåŠŸ\"","        else","            log_warning \"ç®¡ç†å¾Œå°æ§‹å»ºå¯èƒ½å¤±æ•—\"","            build_success=false","        fi","    fi","    ","    # æª¢æŸ¥ MiniWeb","    if [ -d \"web\" ]; then","        if [ -d \"web/.next\" ] || [ -d \"web/out\" ] || [ -d \"web/dist\" ]; then","            log_success \"MiniWeb æ§‹å»ºæˆåŠŸ\"","        else","            log_warning \"MiniWeb æ§‹å»ºå¯èƒ½å¤±æ•—\"","            build_success=false","        fi","    fi","    ","    # æª¢æŸ¥å¾Œç«¯æœå‹™","    if [ -d \"functions\" ]; then","        if [ -d \"functions/dist\" ]; then","            log_success \"å¾Œç«¯æœå‹™æ§‹å»ºæˆåŠŸ\"","        else","            log_warning \"å¾Œç«¯æœå‹™æ§‹å»ºå¯èƒ½å¤±æ•—\"","            build_success=false","        fi","    fi","    ","    if [ \"$build_success\" = true ]; then","        log_success \"æ‰€æœ‰é …ç›®æ§‹å»ºå®Œæˆï¼\"","    else","        log_warning \"éƒ¨åˆ†é …ç›®æ§‹å»ºå¯èƒ½å¤±æ•—ï¼Œè«‹æª¢æŸ¥æ—¥èªŒ\"","    fi","}","","# é¡¯ç¤ºæ§‹å»ºä¿¡æ¯","show_build_info() {","    echo \"\"","    echo \"========================================\"","    echo \"ğŸ—ï¸  æ§‹å»ºå®Œæˆï¼\"","    echo \"========================================\"","    echo \"\"","    echo \"ğŸ“ æ§‹å»ºè¼¸å‡ºç›®éŒ„ï¼š\"","    ","    if [ -d \"admin/.next\" ]; then","        echo \"   â€¢ ç®¡ç†å¾Œå°: admin/.next/\"","    fi","    ","    if [ -d \"admin/out\" ]; then","        echo \"   â€¢ ç®¡ç†å¾Œå°: admin/out/\"","    fi","    ","    if [ -d \"admin/dist\" ]; then","        echo \"   â€¢ ç®¡ç†å¾Œå°: admin/dist/\"","    fi","    ","    if [ -d \"web/.next\" ]; then","        echo \"   â€¢ MiniWeb: web/.next/\"","    fi","    ","    if [ -d \"web/out\" ]; then","        echo \"   â€¢ MiniWeb: web/out/\"","    fi","    ","    if [ -d \"web/dist\" ]; then","        echo \"   â€¢ MiniWeb: web/dist/\"","    fi","    ","    if [ -d \"functions/dist\" ]; then","        echo \"   â€¢ å¾Œç«¯æœå‹™: functions/dist/\"","    fi","    ","    echo \"\"","    echo \"ğŸš€ ä¸‹ä¸€æ­¥ï¼š\"","    echo \"   â€¢ é–‹ç™¼æ¨¡å¼: npm run dev\"","    echo \"   â€¢ éƒ¨ç½²: npm run deploy\"","    echo \"   â€¢ æ¸…ç†: npm run clean\"","    echo \"\"","}","","# ä¸»å‡½æ•¸","main() {","    echo \"========================================\"","    echo \"ğŸš€ ShopBot å¤šå¹³å°é›»å•†ç³»çµ± - çµ±ä¸€æ§‹å»º\"","    echo \"========================================\"","    echo \"\"","    ","    # æª¢æŸ¥ç’°å¢ƒ","    check_node_version","    check_npm_version","    ","    # æ¸…ç†èˆŠçš„æ§‹å»ºæ–‡ä»¶","    clean_build_files","    ","    # å®‰è£ä¾è³´","    install_dependencies","    ","    # æ§‹å»ºå„å€‹é …ç›®","    build_admin","    build_web","    build_functions","    ","    # æª¢æŸ¥æ§‹å»ºçµæœ","    check_build_results","    ","    # é¡¯ç¤ºæ§‹å»ºä¿¡æ¯","    show_build_info","}","","# åŸ·è¡Œä¸»å‡½æ•¸","main \"$@\"",""],"tokenizedAddedLines":[1000000,1000001,1000002,1000003,1000002,1000001,1000004,1000001,1000005,1000006,1000007,1000008,1000009,1000010,1000001,1000011,1000012,1000013,1000014,1000001,1000015,1000016,1000014,1000001,1000017,1000018,1000014,1000001,1000019,1000020,1000014,1000001,1000021,1000022,1000023,1000024,1000025,1000026,1000027,1000028,1000024,1000029,1000030,1000024,1000031,1000032,1000027,1000028,1000024,1000033,1000014,1000001,1000034,1000035,1000036,1000024,1000037,1000038,1000027,1000028,1000024,1000039,1000040,1000024,1000041,1000042,1000027,1000028,1000024,1000043,1000014,1000001,1000044,1000045,1000046,1000024,1000047,1000048,1000049,1000050,1000028,1000024,1000051,1000052,1000053,1000028,1000024,1000054,1000055,1000056,1000028,1000024,1000057,1000058,1000059,1000060,1000028,1000024,1000061,1000062,1000063,1000028,1000024,1000064,1000065,1000066,1000028,1000024,1000067,1000068,1000069,1000070,1000028,1000024,1000071,1000014,1000001,1000072,1000073,1000074,1000024,1000075,1000076,1000077,1000078,1000028,1000024,1000079,1000080,1000081,1000082,1000078,1000083,1000028,1000024,1000084,1000085,1000086,1000087,1000078,1000083,1000028,1000024,1000088,1000089,1000090,1000091,1000078,1000083,1000028,1000024,1000092,1000014,1000001,1000093,1000094,1000095,1000024,1000080,1000082,1000096,1000097,1000098,1000099,1000100,1000101,1000102,1000103,1000096,1000083,1000104,1000105,1000028,1000014,1000001,1000106,1000107,1000108,1000024,1000085,1000087,1000096,1000097,1000098,1000099,1000109,1000101,1000110,1000103,1000096,1000083,1000104,1000111,1000028,1000014,1000001,1000112,1000113,1000114,1000024,1000089,1000091,1000096,1000097,1000098,1000099,1000115,1000101,1000116,1000103,1000096,1000083,1000104,1000117,1000028,1000014,1000001,1000118,1000119,1000120,1000024,1000121,1000024,1000122,1000123,1000124,1000125,1000101,1000126,1000127,1000103,1000028,1000024,1000128,1000129,1000130,1000131,1000101,1000132,1000127,1000103,1000028,1000024,1000133,1000134,1000135,1000136,1000101,1000137,1000127,1000103,1000028,1000024,1000138,1000139,1000104,1000140,1000028,1000014,1000001,1000141,1000142,1000143,1000144,1000145,1000144,1000143,1000146,1000024,1000048,1000147,1000028,1000024,1000051,1000148,1000028,1000024,1000054,1000149,1000028,1000024,1000058,1000150,1000028,1000024,1000061,1000151,1000028,1000024,1000064,1000152,1000028,1000024,1000068,1000153,1000028,1000024,1000143,1000154,1000155,1000156,1000157,1000143,1000014,1000001,1000158,1000159,1000144,1000160,1000144,1000143,1000024,1000161,1000162,1000163,1000024,1000164,1000165,1000024,1000166,1000167,1000024,1000168,1000169,1000170,1000171,1000024,1000172,1000173,1000024,1000174,1000175,1000014,1000001,1000176,1000177,1000001]}],"gitInfo":{"gitInfo":{"gitRoot":"/home/a0928997578_gmail_com"}},"kind":"KIND_ADDED"}