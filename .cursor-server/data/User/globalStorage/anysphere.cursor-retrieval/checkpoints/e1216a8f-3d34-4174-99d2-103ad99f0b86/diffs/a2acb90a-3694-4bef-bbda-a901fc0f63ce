{"fsPath":"/home/a0928997578_gmail_com/偉大/admin/src/components/PaymentSystem.tsx","fileUuid":"a2acb90a-3694-4bef-bbda-a901fc0f63ce","fileSizeBytes":11626,"numLines":300,"diffChanges":[{"originalStartLineNumberOneIndexed":1,"originalEndLineNumberExclusiveOneIndexed":1,"modifiedStartLineNumberOneIndexed":1,"modifiedEndLineNumberExclusiveOneIndexed":301,"addedLines":["'use client';","","import { useState, useEffect } from 'react';","import { ","  CreditCardIcon, ","  WalletIcon, ","  CurrencyDollarIcon,","  ChartBarIcon,","  CogIcon,","  ExclamationTriangleIcon","} from '@heroicons/react/24/outline';","import { usePayments } from '@/hooks/useData';","import { formatCurrency } from '@/lib/utils';","","interface PaymentStats {","  totalPayments: number;","  totalAmount: number;","  pendingPayments: number;","  confirmedPayments: number;","  failedPayments: number;","  averageAmount: number;","}","","export default function PaymentSystem() {","  const { payments, loading, error } = usePayments();","  const [stats, setStats] = useState<PaymentStats>({","    totalPayments: 0,","    totalAmount: 0,","    pendingPayments: 0,","    confirmedPayments: 0,","    failedPayments: 0,","    averageAmount: 0,","  });","","  useEffect(() => {","    if (payments.length > 0) {","      const totalAmount = payments.reduce((sum, p) => sum + p.amount, 0);","      const confirmedPayments = payments.filter(p => p.paymentStatus === 'confirmed').length;","      const pendingPayments = payments.filter(p => p.paymentStatus === 'pending').length;","      const failedPayments = payments.filter(p => p.paymentStatus === 'failed').length;","","      setStats({","        totalPayments: payments.length,","        totalAmount,","        pendingPayments,","        confirmedPayments,","        failedPayments,","        averageAmount: totalAmount / payments.length,","      });","    }","  }, [payments]);","","  if (loading) {","    return (","      <div className=\"flex items-center justify-center h-64\">","        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500\"></div>","      </div>","    );","  }","","  if (error) {","    return (","      <div className=\"text-center py-12\">","        <p className=\"text-red-500\">錯誤: {error}</p>","      </div>","    );","  }","","  return (","    <div className=\"space-y-6\">","      {/* 頁面標題 */}","      <div>","        <h1 className=\"text-2xl font-bold text-gray-900\">支付系統管理</h1>","        <p className=\"mt-2 text-sm text-gray-600\">","          管理 USDT-TRC20 支付、錢包和匯率系統","        </p>","      </div>","","      {/* 統計卡片 */}","      <div className=\"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-3\">","        <div className=\"bg-white overflow-hidden shadow rounded-lg\">","          <div className=\"p-5\">","            <div className=\"flex items-center\">","              <div className=\"flex-shrink-0\">","                <div className=\"p-3 rounded-md bg-blue-500\">","                  <CreditCardIcon className=\"h-6 w-6 text-white\" />","                </div>","              </div>","              <div className=\"ml-5 w-0 flex-1\">","                <dl>","                  <dt className=\"text-sm font-medium text-gray-500 truncate\">","                    總支付數","                  </dt>","                  <dd className=\"text-lg font-medium text-gray-900\">","                    {stats.totalPayments.toLocaleString()}","                  </dd>","                </dl>","              </div>","            </div>","          </div>","        </div>","","        <div className=\"bg-white overflow-hidden shadow rounded-lg\">","          <div className=\"p-5\">","            <div className=\"flex items-center\">","              <div className=\"flex-shrink-0\">","                <div className=\"p-3 rounded-md bg-green-500\">","                  <CurrencyDollarIcon className=\"h-6 w-6 text-white\" />","                </div>","              </div>","              <div className=\"ml-5 w-0 flex-1\">","                <dl>","                  <dt className=\"text-sm font-medium text-gray-500 truncate\">","                    總金額","                  </dt>","                  <dd className=\"text-lg font-medium text-gray-900\">","                    {formatCurrency(stats.totalAmount, 'USD')}","                  </dd>","                </dl>","              </div>","            </div>","          </div>","        </div>","","        <div className=\"bg-white overflow-hidden shadow rounded-lg\">","          <div className=\"p-5\">","            <div className=\"flex items-center\">","              <div className=\"flex-shrink-0\">","                <div className=\"p-3 rounded-md bg-yellow-500\">","                  <WalletIcon className=\"h-6 w-6 text-white\" />","                </div>","              </div>","              <div className=\"ml-5 w-0 flex-1\">","                <dl>","                  <dt className=\"text-sm font-medium text-gray-500 truncate\">","                    待處理支付","                  </dt>","                  <dd className=\"text-lg font-medium text-gray-900\">","                    {stats.pendingPayments.toLocaleString()}","                  </dd>","                </dl>","              </div>","            </div>","          </div>","        </div>","","        <div className=\"bg-white overflow-hidden shadow rounded-lg\">","          <div className=\"p-5\">","            <div className=\"flex items-center\">","              <div className=\"flex-shrink-0\">","                <div className=\"p-3 rounded-md bg-green-500\">","                  <ChartBarIcon className=\"h-6 w-6 text-white\" />","                </div>","              </div>","              <div className=\"ml-5 w-0 flex-1\">","                <dl>","                  <dt className=\"text-sm font-medium text-gray-500 truncate\">","                    已確認支付","                  </dt>","                  <dd className=\"text-lg font-medium text-gray-900\">","                    {stats.confirmedPayments.toLocaleString()}","                  </dd>","                </dl>","              </div>","            </div>","          </div>","        </div>","","        <div className=\"bg-white overflow-hidden shadow rounded-lg\">","          <div className=\"p-5\">","            <div className=\"flex items-center\">","              <div className=\"flex-shrink-0\">","                <div className=\"p-3 rounded-md bg-red-500\">","                  <ExclamationTriangleIcon className=\"h-6 w-6 text-white\" />","                </div>","              </div>","              <div className=\"ml-5 w-0 flex-1\">","                <dl>","                  <dt className=\"text-sm font-medium text-gray-500 truncate\">","                    失敗支付","                  </dt>","                  <dd className=\"text-lg font-medium text-gray-900\">","                    {stats.failedPayments.toLocaleString()}","                  </dd>","                </dl>","              </div>","            </div>","          </div>","        </div>","","        <div className=\"bg-white overflow-hidden shadow rounded-lg\">","          <div className=\"p-5\">","            <div className=\"flex items-center\">","              <div className=\"flex-shrink-0\">","                <div className=\"p-3 rounded-md bg-purple-500\">","                  <CogIcon className=\"h-6 w-6 text-white\" />","                </div>","              </div>","              <div className=\"ml-5 w-0 flex-1\">","                <dl>","                  <dt className=\"text-sm font-medium text-gray-500 truncate\">","                    平均金額","                  </dt>","                  <dd className=\"text-lg font-medium text-gray-900\">","                    {formatCurrency(stats.averageAmount, 'USD')}","                  </dd>","                </dl>","              </div>","            </div>","          </div>","        </div>","      </div>","","      {/* 快速操作 */}","      <div className=\"bg-white shadow rounded-lg\">","        <div className=\"px-4 py-5 sm:p-6\">","          <h3 className=\"text-lg font-medium text-gray-900 mb-4\">快速操作</h3>","          <div className=\"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4\">","            <button className=\"flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 transition-colors\">","              查看錢包餘額","            </button>","            <button className=\"flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 transition-colors\">","              同步區塊鏈","            </button>","            <button className=\"flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-purple-600 hover:bg-purple-700 transition-colors\">","              更新匯率","            </button>","            <button className=\"flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-yellow-600 hover:bg-yellow-700 transition-colors\">","              系統設置","            </button>","          </div>","        </div>","      </div>","","      {/* 最近支付記錄 */}","      <div className=\"bg-white shadow rounded-lg\">","        <div className=\"px-4 py-5 sm:p-6\">","          <h3 className=\"text-lg font-medium text-gray-900 mb-4\">最近支付記錄</h3>","          <div className=\"overflow-x-auto\">","            <table className=\"min-w-full divide-y divide-gray-200\">","              <thead className=\"bg-gray-50\">","                <tr>","                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">","                    支付 ID","                  </th>","                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">","                    金額","                  </th>","                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">","                    狀態","                  </th>","                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">","                    支付方式","                  </th>","                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">","                    創建時間","                  </th>","                </tr>","              </thead>","              <tbody className=\"bg-white divide-y divide-gray-200\">","                {payments.slice(0, 10).map((payment) => (","                  <tr key={payment.id} className=\"hover:bg-gray-50\">","                    <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900\">","                      {payment.id.slice(0, 8)}...","                    </td>","                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">","                      {formatCurrency(payment.amount, 'USD')}","                    </td>","                    <td className=\"px-6 py-4 whitespace-nowrap\">","                      <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${","                        payment.paymentStatus === 'confirmed' ? 'bg-green-100 text-green-800' :","                        payment.paymentStatus === 'pending' ? 'bg-yellow-100 text-yellow-800' :","                        payment.paymentStatus === 'failed' ? 'bg-red-100 text-red-800' :","                        'bg-gray-100 text-gray-800'","                      }`}>","                        {payment.paymentStatus === 'confirmed' ? '已確認' :","                         payment.paymentStatus === 'pending' ? '待處理' :","                         payment.paymentStatus === 'failed' ? '失敗' :","                         payment.paymentStatus}","                      </span>","                    </td>","                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">","                      {payment.paymentMethod === 'usdt_trc20' ? 'USDT-TRC20' :","                       payment.paymentMethod === 'usdt_erc20' ? 'USDT-ERC20' :","                       payment.paymentMethod === 'trx' ? 'TRX' : payment.paymentMethod}","                    </td>","                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">","                      {new Date(payment.createdAt).toLocaleDateString()}","                    </td>","                  </tr>","                ))}","              </tbody>","            </table>","          </div>","        </div>","      </div>","    </div>","  );","}",""],"tokenizedAddedLines":[1000000,1000001,1000002,1000003,1000004,1000005,1000006,1000007,1000008,1000009,1000010,1000011,1000012,1000001,1000013,1000014,1000015,1000016,1000017,1000018,1000019,1000020,1000001,1000021,1000022,1000023,1000024,1000025,1000026,1000027,1000028,1000029,1000030,1000001,1000031,1000032,1000033,1000034,1000035,1000036,1000001,1000037,1000038,1000039,1000040,1000041,1000042,1000043,1000044,1000045,1000046,1000001,1000047,1000048,1000049,1000050,1000051,1000052,1000053,1000001,1000054,1000048,1000055,1000056,1000051,1000052,1000053,1000001,1000057,1000058,1000059,1000060,1000061,1000062,1000063,1000064,1000051,1000001,1000065,1000066,1000067,1000068,1000069,1000070,1000071,1000072,1000073,1000074,1000075,1000076,1000077,1000078,1000079,1000080,1000081,1000082,1000083,1000074,1000084,1000085,1000086,1000001,1000067,1000068,1000069,1000070,1000087,1000088,1000073,1000074,1000075,1000076,1000077,1000089,1000079,1000080,1000090,1000082,1000083,1000074,1000084,1000085,1000086,1000001,1000067,1000068,1000069,1000070,1000091,1000092,1000073,1000074,1000075,1000076,1000077,1000093,1000079,1000080,1000094,1000082,1000083,1000074,1000084,1000085,1000086,1000001,1000067,1000068,1000069,1000070,1000087,1000095,1000073,1000074,1000075,1000076,1000077,1000096,1000079,1000080,1000097,1000082,1000083,1000074,1000084,1000085,1000086,1000001,1000067,1000068,1000069,1000070,1000098,1000099,1000073,1000074,1000075,1000076,1000077,1000100,1000079,1000080,1000101,1000082,1000083,1000074,1000084,1000085,1000086,1000001,1000067,1000068,1000069,1000070,1000102,1000103,1000073,1000074,1000075,1000076,1000077,1000104,1000079,1000080,1000105,1000082,1000083,1000074,1000084,1000085,1000086,1000051,1000001,1000106,1000107,1000108,1000109,1000110,1000111,1000112,1000113,1000114,1000115,1000113,1000116,1000117,1000113,1000118,1000119,1000113,1000085,1000086,1000051,1000001,1000120,1000107,1000108,1000121,1000122,1000123,1000124,1000125,1000126,1000127,1000128,1000126,1000129,1000128,1000126,1000130,1000128,1000126,1000131,1000128,1000126,1000132,1000128,1000133,1000134,1000135,1000136,1000137,1000138,1000139,1000140,1000141,1000142,1000140,1000143,1000144,1000145,1000146,1000147,1000148,1000149,1000150,1000151,1000152,1000153,1000154,1000140,1000141,1000155,1000156,1000157,1000140,1000158,1000159,1000140,1000160,1000161,1000162,1000163,1000085,1000086,1000051,1000164,1000165,1000020,1000001]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_ADDED"}